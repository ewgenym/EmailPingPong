using System;
using EmailPingPong.Core.Comparers;
using EmailPingPong.Core.Model;
using FluentAssertions;
using Xunit;

namespace EmailPingPong.Tests.Core
{
	public class EmailItemComparerTests
	{
		[Fact]
		public void should_report_two_emails_are_equal()
		{
			var email1 = new EmailItem
				{
					Id = 0,
					AccountId = "ema@scalepoint.com",
					CreationTime = DateTime.Parse("4/11/2013 7:19:24 PM"),
					Folder = new EmailFolder("0000000038A1BB1005E5101AA1BB08002B2A56C20000454D534D44422E444C4C00000000000000001B55FA20AA6611CD9BC800AA002FC45A0C0000004558323031302D46453031002F6F3D53504350482F6F753D45786368616E67652041646D696E6973747261746976652047726F7570202846594449424F484632335350444C54292F636E3D526563697069656E74732F636E3D457667656E6979204D616B73616B61373800", "000000002FD74BC9E9734B40A051DC93E9747A2C010090532BD2FA831742A83071C02602FB4700000056D9630000", "Inbox"),
					IsUnread = true,
					ItemId = "000000002FD74BC9E9734B40A051DC93E9747A2C070090532BD2FA831742A83071C02602FB4700000056D963000090532BD2FA831742A83071C02602FB4700009A1EFB800000",
					Subject = "RE: wertyuiolp;"
				};

			var email2 = new EmailItem
			{
				Id = 0,
				AccountId = "ema@scalepoint.com",
				CreationTime = DateTime.Parse("4/11/2013 7:19:24 PM"),
				Folder = new EmailFolder("0000000038A1BB1005E5101AA1BB08002B2A56C20000454D534D44422E444C4C00000000000000001B55FA20AA6611CD9BC800AA002FC45A0C0000004558323031302D46453031002F6F3D53504350482F6F753D45786368616E67652041646D696E6973747261746976652047726F7570202846594449424F484632335350444C54292F636E3D526563697069656E74732F636E3D457667656E6979204D616B73616B61373800", "000000002FD74BC9E9734B40A051DC93E9747A2C010090532BD2FA831742A83071C02602FB4700000056D9630000", "Inbox"),
				IsUnread = true,
				ItemId = "000000002FD74BC9E9734B40A051DC93E9747A2C070090532BD2FA831742A83071C02602FB4700000056D963000090532BD2FA831742A83071C02602FB4700009A1EFB800000",
				Subject = "RE: wertyuiolp;"
			};

			var comparer = new EmailItemComparer();
			var result = comparer.Equals(email1, email2);

			result.Should().BeTrue();
		}
	}
}